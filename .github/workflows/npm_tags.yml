name: 'NPM tag'
on:
    workflow_call:
      inputs:
        version:
          type: string
        tag:
          type: string
    workflow_dispatch:
      inputs:
        version:
          type: string
        tag:
          type: string

jobs:
    change_tags:
        name: Change tags
        runs-on: ubuntu-latest
        steps:
            - name: Change tags
              env:
                  NODE_AUTH_TOKEN: ${{ secrets.NPM_PUBLISH_TOKEN }}
                  TAG: ${{ inputs.tag }}
                  VERSION: ${{ inputs.version }}
              if: env.NODE_AUTH_TOKEN != null
              run: |
                  npm dist-tag ls @duckdb/duckdb-wasm@"${VERSION}"
                  npm dist-tag add @duckdb/duckdb-wasm@"${VERSION}" "${TAG}"
                  npm dist-tag ls @duckdb/duckdb-wasm@"${VERSION}"
